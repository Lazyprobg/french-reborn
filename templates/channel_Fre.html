<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>French Reborn</title>
</head>
<body>

<h3>Connect√© en tant que {{ username }}</h3>

<div id="chat"></div>

<input id="msg">
<button onclick="send()">Envoyer</button>

<script>
const chat = document.getElementById("chat");
const msg = document.getElementById("msg");

function load(){
    fetch("/messages")
        .then(r => r.json())
        .then(d => {
            chat.innerHTML = "";
            d.forEach(m => {
                chat.innerHTML += `<div><b>${m.username}</b>: ${m.content}</div>`;
            });
        });
}

function send(){
    if(!msg.value.trim()) return;
    fetch("/send", {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({content: msg.value})
    });
    msg.value = "";
}

setInterval(load, 1500);
load();
</script>

</body>
</html>
